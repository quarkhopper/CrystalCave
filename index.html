<!DOCTYPE html>
<html>
	<head>
		<script src="https://aframe.io/releases/0.3.0/aframe.min.js"></script>
		<script src="https://cdn.rawgit.com/AltspaceVR/aframe-altspace-component/v1.3.1/dist/aframe-altspace-component.min.js"></script>
		<script src="https://sdk.altvr.com/libs/altspace.js/0.28.1/altspace.min.js"></script>
		<script src="https://cdn.rawgit.com/mrdoob/three.js/r74/build/three.min.js"></script>
		<script src="lib/three-glTFLoader.min.js"></script>
	</head>
	<body>
		<script>
		
		var sim = altspace.utilities.Simulation();
		sim.camera.position.z = 5;
		var config = { authorId: 'FACEMAN', appId: 'Crystals' };
		var sceneSync;
		altspace.utilities.sync.connect(config).then(function(connection) {
			sceneSync = altspace.utilities.behaviors.SceneSync(connection.instance, {
				instantiators: {
					'Crystals': createCrystals,
				},
				ready: ready
			});
			sim.scene.addBehavior(sceneSync);
		});
		
		function createCrystals() {
			
			var loader = new THREE.glTFLoader();
			var crystals;
			loader.load('assets/crystals.gltf', function(result)
			{
				crystals = result.scene.children[0].children[0];
			});
			sim.scene.add(crystals);
			return crystals;
		}
		
		function ready(firstInstance) {
			if (firstInstance) {
				sceneSync.instantiate('Crystals');
			}
		}
		</script>
	</body>
</html>
